extends ../layouts/application.pug

block title
  | #{campaign.title} — The Debt Collective

block styles
  link(href='/build/stylesheets/campaigns/show.css' rel='stylesheet')

block content
  .bg-light-pattern.-dark
    .px2(data-offset-section)

      .max-width-4.mx-auto(data-tabs-component)

        div(data-fixed-tabs-component)
          unless campaign.published
            .Alert.wrapper.center.-fw-500.-warning
              p This campaign is currently on Staging mode. #[a(href=routeMappings.Admin.Campaigns.edit.url(campaign.id)) Edit campaign] to make it public.
          ul.list-reset.flex.-bg-neutral-light(role='tablist')
            li.Tab.flex.flex-auto.p1.-dark(role='tab' aria-controls='panel-campaign' aria-selected='true')
              .flex.items-center
                svg.-sw7.-stroke-dark(width='40' height='40')
                  use(xlink:href=`#svg-collective-${campaign.collective.id.charAt(0)}`)
              .pl2
                div
                  h4.inline-block.pr1= campaign.title
                  a.-fw-700(href=routeMappings.Collectives.show.url(campaign.collective.id))= campaign.collective.name
                p.-caption.-fw-500
                  | #{(userBelongsToCampaign ? `You + ${campaign.userCount - 1}` : campaign.userCount) + ' people joined with $10,560 USD in debt'}
                  if canCreateEvents
                    span.-fw-700.px1 •
                    a.-fw-700(href=routeMappings.Admin.Campaigns.edit.url(campaign.id)) Edit campaign

            li.Tab.flex-auto.p2.-fw-700.-dark.items-center.flex(role='tab' aria-controls='panel-resources' aria-selected='false')
              .flex-auto
                | Resources
                span.right.-caption.-neutral-mid 9
            li.Tab.p2.-fw-700.-dark.flex.items-center
              div
                | Share
                ul.list-reset.inline-block.ml3
                  li.inline-block
                    a.px1.-dark(href='#' rel="noopener noreferrer" target="_blank" data-share-url-twitter)
                      svg(width="13" height="11"): use(xlink:href="#svg-twitter")
                      .sr-only Twitter
                  li.inline-block
                    a.px1.-dark(href='#' rel="noopener noreferrer" target="_blank" data-share-url-facebook)
                      svg(width="6" height="13"): use(xlink:href="#svg-facebook")
                      .sr-only Facebook

        .Campaigns_TabPanes
          section#panel-campaign.TabPane.pt3(role='tabpanel' aria-hidden='false')
            if campaign.active
              include ../includes/campaigns/active-view
            else
              include ../includes/campaigns/inactive-view

          section#panel-resources.TabPane(role='tabpanel' aria-hidden='true')
            | Resources

block scripts
  script(src='/build/javascripts/campaigns/show.js' async)
  script.
    window.addEventListener('load', function() {
      var options = {
        currentUser: !{JSON.stringify(currentUser)},
        currentURL: !{JSON.stringify(currentURL)},
        campaignId: !{JSON.stringify(campaign.id)},
        campaignTitle: !{JSON.stringify(campaign.title)},
        nextEvents: !{JSON.stringify(nextEvents)},
        googleMapsKey: !{JSON.stringify(CONFIG.env().GoogleMaps.key)},
      };
      try {
        new ViewCampaignsShow(options);
      } catch(e) {
        airbreak.notify(e);
      }
    }, true);

